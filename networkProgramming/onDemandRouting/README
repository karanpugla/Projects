=================
CSE 533: Network Programming
Assignment 3
=================
Karan Pugla         110452661
Ravi Prakash Pandey 110384652

Note: Input to client must be VM NUMBER. For e.g. 5 is right input and vm5 is wrong input format.

1. INSTALL
===========
FILES: common.h odr.c server.c client.c get_hw_address.c hw_addrs.h Makefile README

a. copy all FILES in a directory
b. cd to the directory where Makefile is located
c. run 'make all'
d. Make sure following files are generated in current directory

OUTPUT FILES: client_kpugla, server_kpugla, odr_kpugla

2. RUN
===========
a. Deploy client_kpugla, server_kpugla, odr_kpugla in all the 10 VMs
b. Run server_kpugla and odr_kpugla on all the VMs
c. On running client_kpugla, enter a VM NUMBER to choose the server.
Note: Input to client must be VM NUMBER. For e.g. 5 is right input and vm5 is wrong input format.
e. You will receive timestamp from the server.


3. DESIGN
===========

3.1. Architecture and working

Client/ Server Design
- Server creates a unix domain datagram socket to send timestamp to ODR and
  receive application payload message from ODR. It uses a well known sun_path to
  bind the above socket.
  After it receives the application payload message from ODR,
  it gets the current timestamp and sends it to the ODR to be routed
  back to the client.

- Client creates a unix domain datagram socket to send time request to ODR. ODR
  then takes this request and routes to the server chosen by client. It
  identifies the server and client by their canonical IP addresses.
  After the server sends back the timestamp through ODR, ODR replies back to
  client by the above socket created.

ODR Design
- ODR creates two sockets, one is UNIX domain to send/receive messages from client server
  and another PF_PACKET socket to perform route discovery.
  If a packet is received on UNIX domain socket, ODR checks if it has a valid route to route the packet
  received on the UNIX domain socket. If it has a valid route, the packet is passed to next hop found in the route.
  If message received on domain socket has flag set, then route discovery is performed even if ODR has a valid route.
  ODR also assigns temporary ports to client and maps those ports to their SUN_PATH.
  
  If ODR does not have route, then it performs route discovery. It stores this pending message to be sent later
  when route discovery is complete. Each RREQ generated by ODR has unique broadastid and incremented every time a new RREQ is 
  generated by ODR. The pending message is stored using broadcast id as key, so that when RREP is received for this broadcast
  id, ODR can send get this stored message and send it.

- Everytime any message RREQ, RREP or Application payload is received on ODR PF_PACKET socket, ODR creates a reverse route 
  to sender of this packet. If ODR already has reverse route, then reverse route is updated only if it is better than what 
  it already has.

- If force flag is set in RREQ, then all intermediary nodes, even if they have a route, flushes their route and 
  broadcasts the received RREQ.
